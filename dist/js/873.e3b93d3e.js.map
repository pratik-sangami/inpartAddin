{"version":3,"file":"js/873.e3b93d3e.js","mappings":";;AAMA,SAASA,EAAcC,GACnB,YAAwBC,IAAjBD,EAAME,MACjB;;ACFA,MAAMC,EAAmB,CACrBC,wBAAyB,4BACzBC,WAAY,cACZC,UAAW,aACXC,eAAgB,kBAChBC,gBAAiB,mBACjBC,SAAU,WACVC,mBAAoB,sBACpBC,yBAA0B;;ACJ9B,MAAMC,EACF,WAAAC,CAAYC,EAAUC,EAAoBC,EAAQC,GAC9CC,KAAKJ,SAAWA,EAChBI,KAAKH,mBAAqBA,EAC1BG,KAAKF,OAASA,EACdE,KAAKD,OAASA,CAClB,CACA,iBAAAE,CAAkBC,GACd,IAAIC,EAEAA,OADiCpB,IAAjCmB,EAAQE,qBACM,IAAIC,IAGJ,IAAIA,IAAIC,OAAOC,QAAQL,EAAQE,uBAEjD,MAAMI,EAAiB,IAAIC,EAAA,EACrBC,EAASF,EAAeG,8BAA8BT,EAAQQ,OAAQV,KAAKH,oBAC3Ee,EAASV,EAAQU,QAAU,KAC3BC,EAAe,CACjBC,iBAAkBZ,EAAQa,SAASC,cACnCpB,SAAUI,KAAKJ,SACfqB,UAAWf,EAAQe,UACnBC,MAAON,EAAOO,KAAK,KACnBC,mBAAyCrC,IAA1BmB,EAAQkB,cACjBlB,EAAQkB,cACRpB,KAAKF,OAAOuB,gBAClBX,OAASY,EAAA,EAAYC,WAAWb,QAAmB3B,EAAT2B,EAC1Cc,MAAOtB,EAAQsB,MACfC,qBAAsBvB,EAAQuB,sBAAwB,KAAqBC,OAC3EC,gBAAiBxB,GAErB,OAAOU,CACX,CACA,oBAAAe,CAAqB1B,EAAS2B,EAAUC,GACpC,IAAKD,EAASE,MAAMC,WAAaH,EAASE,MAAME,aAC5C,MAAM,QAAsBC,EAAA,IAEhC,MAAMC,EAAY,IAAIC,KAAyD,KAAnDN,GAAgBD,EAASE,MAAMM,YAAc,KACnEC,EAAgBC,EAAA,GAA6BV,EAASE,MAAMC,SAAUhC,KAAKF,OAAO0C,cAClFzB,EAAUf,KAAKyC,mBAAmBZ,EAASd,QAASuB,GACpD1B,EAASiB,EAASE,MAAMb,OAAShB,EAAQgB,MACzCwB,EAAuB,CACzBzB,UAAWY,EAASE,MAAMd,WAAaF,EAAQ4B,YAC/CC,SAAU7B,EAAQ8B,eAClBC,SAAU/B,EAAQ+B,SAClBlC,OAAQA,EAAOmC,MAAM,KACrBhC,UACAiC,QAASnB,EAASE,MAAMC,SACxBM,gBACAW,YAAapB,EAASE,MAAME,aAC5BiB,WAAW,EACXf,UAAWA,EACXgB,UAAWjD,EAAQuB,sBAAwB,KAAqBC,OAChEN,cAAelB,EAAQkB,cACvBgC,aAAcjB,EACdX,MAAOtB,EAAQsB,OAEnB,OAAOkB,CACX,CAuBA,kBAAAD,CAAmBY,EAAaf,GAC5B,MAAMgB,EAAyBhB,GAAiBe,EAAYf,cACtDO,EAAiBQ,EAAYR,gBAC/BS,GAAwBC,KACxBD,GAAwBE,KACxB,GACEV,EAAWO,EAAYP,UAAYQ,GAAwBG,KAAO,GAClEzC,EAAgBqC,EAAYrC,eAAiB,GAAG6B,KAAkBC,IAClEY,EAAWL,EAAYK,UACzBJ,GAAwBK,oBACxB,GACEC,EAAOP,EAAYO,MAAQN,GAAwBM,KACnD7C,EAAU,CACZC,gBACA2B,YAAaU,EAAYV,YACzBG,WACAY,WACAb,iBACAe,OACAZ,QAASK,EAAYL,QACrBV,cAAegB,GAEnB,OAAOvC,CACX,CAMA,eAAA8C,CAAgB/E,GACZ,IAAID,EAAcC,GAuBd,OAAO,IAAIgF,EAAA,GAAU,gBAAiB,6BAtBtC,OAAQhF,EAAME,QACV,KAAKC,EAAiBE,WAClB,OAAO,IAAI4E,EAAA,GAAgB7B,EAAA,IAC/B,KAAKjD,EAAiBG,UAClB,OAAO,IAAI2E,EAAA,GAAgB7B,EAAA,IAC/B,KAAKjD,EAAiBO,mBAClB,OAAO,IAAIuE,EAAA,GAAgB7B,EAAA,IAC/B,KAAKjD,EAAiBM,SAClB,OAAO,IAAIwE,EAAA,GAAgB7B,EAAA,IAC/B,KAAKjD,EAAiBQ,yBAClB,OAAO,IAAIsE,EAAA,GAAgBjF,EAAMkF,MAC7B9B,EAAA,GAAkDpD,EAAMmF,aAChE,KAAKhF,EAAiBI,eACtB,KAAKJ,EAAiBK,gBAClB,OAAO,IAAI4E,EAAA,EAAYpF,EAAMkF,KAAMlF,EAAMmF,aAC7C,KAAKhF,EAAiBC,wBAClB,OAAO,IAAIiF,EAAA,GAA6BrF,EAAMkF,KAAMlF,EAAMmF,aAC9D,QACI,OAAO,IAAIH,EAAA,GAAUhF,EAAMkF,KAAMlF,EAAMmF,aAMvD;;ACvIJ,MAAMG,EAA4B,CAC9BC,kBAAmB,CACfL,KAAM,qBACNM,KAAM,iEAGd,MAAMC,UAA2BT,EAAA,GAC7B,WAAAnE,CAAY6E,EAAWC,GACnBC,MAAMF,EAAWC,GACjBnE,OAAOqE,eAAe3E,KAAMuE,EAAmBK,WAC/C5E,KAAK4D,KAAO,oBAChB,CACA,6BAAOiB,GACH,OAAO,IAAIN,EAAmBH,EAA0BC,kBAAkBL,KAAMI,EAA0BC,kBAAkBC,KAChI,E;;ACXJ,MAAMQ,EACF,WAAAnF,CAAYoF,GACR/E,KAAK+E,iBAAmBA,EACxB,MAAMC,EAAQhF,KAAK+E,iBAAiBE,iBACpC,QAAclG,IAAViG,EAIA,MAAM,IAAIE,MAAM,wCAHhBlF,KAAKmF,YAAcH,EAMvBhF,KAAKoF,OAASL,EAAiBM,YAE/BrF,KAAKD,OAASC,KAAK+E,iBAAiBO,YAEpCtF,KAAKuF,kBAAoBvF,KAAKoF,OAAOI,UAAUC,OAE/CzF,KAAK0F,cAAgBX,EAAiBY,uBAChC,IAAIC,EAAA,EAAU5F,KAAKD,OAAQC,KAAKuF,mBAChC,IACNvF,KAAK6F,aAAe,IAAIC,EAAA,EAAa9F,KAAKD,OAAQC,KAAK0F,eACvD1F,KAAK+F,qBAAuB,IAAIrG,EAAqBM,KAAKoF,OAAOY,KAAKpG,SAAUI,KAAKoF,OAAOY,KAAKnG,mBAAoBG,KAAK0F,cAAe1F,KAAKD,OAClJ,CACA,iBAAAkG,GACI,MAAM1B,EAAmBM,wBAC7B,CACA,eAAAqB,GACI,OAAOlG,KAAK6F,YAChB,CACA,6BAAaM,CAAiBpB,GAC1B,MAAMqB,EAAa,IAAItB,EAAwBC,GAC/C,OAAOsB,QAAQC,QAAQF,EAC3B,CACA,UAAAG,GAEI,OAAOF,QAAQC,SACnB,CACA,kBAAAE,CAAmBtG,GACf,OAAIA,GAASkB,cACFlB,EAEJ,IACAA,EACHkB,cAAepB,KAAK0F,cAAcrE,gBAE1C,CACA,6BAAMoF,CAAwBvG,GAC1B,MAAMwG,EAAe1G,KAAKwG,mBAAmBtG,GAC7CF,KAAK6F,aAAac,UAAUC,EAAA,EAAUC,oBAAqB,KAAgBC,MAAOJ,GAClF,MAAMK,EAAqB/G,KAAKuF,kBAAkByB,iBAAiBC,EAAA,GAAkBC,kBAAmBR,EAAatF,eACrH2F,GAAoBI,IAAI,CAAEC,sBAAsB,IAChD,IACI,MAAMC,EAAarH,KAAK+F,qBAAqB9F,kBAAkByG,GACzD5E,EAAewF,EAAA,KACfzF,QAAiB7B,KAAKmF,YAAYoC,oBAAoBF,GACtDG,EAASxH,KAAK+F,qBAAqBnE,qBAAqByF,EAAYxF,EAAUC,GAWpF,OAVA9B,KAAK+E,iBAAiB0C,iBAAiBD,EAAOzG,SAC9Cf,KAAK6F,aAAac,UAAUC,EAAA,EAAUc,sBAAuB,KAAgBZ,MAAOU,GACpFT,EAAmBI,IAAI,CACnBQ,gBAAiBH,EAAOvE,YAAY2E,OACpCC,YAAaL,EAAOxE,QAAQ4E,SAEhCb,EAAmBe,IAAI,CACnBC,SAAS,EACTC,UAAWR,EAAOQ,YAEfR,CACX,CACA,MAAOS,GACH,MAAMnJ,EAAQkB,KAAK+F,qBAAqBlC,gBAAgBoE,GAKxD,MAJAjI,KAAK6F,aAAac,UAAUC,EAAA,EAAUsB,sBAAuB,KAAgBpB,MAAO,KAAMmB,GAC1FlB,EAAmBe,IAAI,CACnBC,SAAS,GACVE,GACGnJ,CACV,CACJ,CACA,gCAAMqJ,CAA2BjI,GAC7B,MAAMwG,EAAe1G,KAAKwG,mBAAmBtG,GAC7CF,KAAK6F,aAAac,UAAUC,EAAA,EAAUC,oBAAqB,KAAgBuB,OAAQ1B,GACnF,MAAM2B,EAAuBrI,KAAKuF,kBAAkByB,iBAAiBC,EAAA,GAAkBqB,UAAW5B,EAAatF,eAC/GiH,GAAsBE,UAAU,CAC5BC,sBAAuB,IAE3BH,GAAsBlB,IAAI,CACtBC,sBAAsB,IAE1B,IACI,MAAMC,EAAarH,KAAK+F,qBAAqB9F,kBAAkByG,GACzD5E,EAAewF,EAAA,KACfzF,QAAiB7B,KAAKmF,YAAYsD,eAAepB,GACjDG,EAASxH,KAAK+F,qBAAqBnE,qBAAqByF,EAAYxF,EAAUC,GAWpF,OAVA9B,KAAK+E,iBAAiB0C,iBAAiBD,EAAOzG,SAC9Cf,KAAK6F,aAAac,UAAUC,EAAA,EAAUc,sBAAuB,KAAgBU,OAAQZ,GACrFa,GAAsBlB,IAAI,CACtBQ,gBAAiBH,EAAOvE,YAAY2E,OACpCC,YAAaL,EAAOxE,QAAQ4E,SAEhCS,GAAsBP,IAAI,CACtBC,SAAS,EACTC,UAAWR,EAAOQ,YAEfR,CACX,CACA,MAAOS,GACH,MAAMnJ,EAAQkB,KAAK+F,qBAAqBlC,gBAAgBoE,GAKxD,MAJAjI,KAAK6F,aAAac,UAAUC,EAAA,EAAUsB,sBAAuB,KAAgBE,OAAQ,KAAMH,GAC3FI,GAAsBP,IAAI,CACtBC,SAAS,GACVE,GACGnJ,CACV,CACJ,CACA,uBAAM4J,CAAkBxI,GACpB,OAAOF,KAAKyG,wBAAwBvG,EACxC,CAEA,oBAAAyI,CAAqBzI,GACjB,MAAMqE,EAAmBM,wBAC7B,CACA,wBAAM+D,CAAmBC,GACrB,OAAO7I,KAAKmI,2BAA2BU,EAC3C,CAEA,kBAAAC,CAAmB5I,GAEf,MAAMqE,EAAmBM,wBAC7B,CACA,kBAAAkE,CAAmB7I,EAAS8I,EAC5BC,GAEI,MAAM1E,EAAmBM,wBAC7B,CACA,0BAAAqE,CAA2BC,EAC3BN,GAEI,MAAMtE,EAAmBM,wBAC7B,CAKA,gBAAAuE,CAAiBC,GACb,OAAOrJ,KAAK6F,aAAauD,iBAAiBC,EAC9C,CAKA,mBAAAC,CAAoBC,GAChBvJ,KAAK6F,aAAayD,oBAAoBC,EAC1C,CAEA,sBAAAC,CAAuBH,GACnB,MAAM9E,EAAmBM,wBAC7B,CAEA,yBAAA4E,CAA0BF,GACtB,MAAMhF,EAAmBM,wBAC7B,CACA,0BAAA6E,GACI,MAAMnF,EAAmBM,wBAC7B,CACA,2BAAA8E,GACI,MAAMpF,EAAmBM,wBAC7B,CAEA,UAAA+E,CAAWC,GACP,MAAMtF,EAAmBM,wBAE7B,CACA,kBAAAiF,CAAmB9I,GACf,MAAM+I,EAAiB/J,KAAK+E,iBAAiBiF,mBAC7C,YAAuBjL,IAAnBgL,GACIA,EAAe/I,gBAAkBA,EAC1BhB,KAAK+F,qBAAqBtD,mBAAmBsH,GAOjD,IAEf,CACA,mBAAAE,CAAoBC,GAChB,MAAMH,EAAiB/J,KAAK+E,iBAAiBiF,mBAC7C,YAAuBjL,IAAnBgL,GACIA,EAAelH,iBAAmBqH,EAC3BlK,KAAK+F,qBAAqBtD,mBAAmBsH,GAOjD,IAEf,CACA,oBAAAI,CAAqBC,GACjB,MAAML,EAAiB/J,KAAK+E,iBAAiBiF,mBAC7C,YAAuBjL,IAAnBgL,GACIA,EAAerG,WAAa0G,EACrBpK,KAAK+F,qBAAqBtD,mBAAmBsH,GAOjD,IAEf,CACA,cAAAM,GACI,MAAMN,EAAiB/J,KAAK+E,iBAAiBiF,mBAC7C,YAAuBjL,IAAnBgL,EACO,CACH/J,KAAK+F,qBAAqBtD,mBAAmBsH,IAI1C,EAEf,CACA,qBAAAO,CAAsBC,GAElB,OAAOlE,QAAQC,QAAQ,KAC3B,CACA,UAAAkE,CAAWtK,GAEP,OAAOF,KAAKyG,wBAAwBvG,GAAW,KACnD,CAEA,aAAAuK,CAAcvK,GACV,MAAMqE,EAAmBM,wBAC7B,CAEA,MAAA6F,CAAOC,GACH,MAAMpG,EAAmBM,wBAC7B,CACA,cAAA+F,CAAeD,GAEX,MAAMpG,EAAmBM,wBAC7B,CACA,WAAAgG,CAAYF,GAER,MAAMpG,EAAmBM,wBAC7B,CACA,SAAAiG,CAEA5K,GACI,OAAOF,KAAKmI,2BAA2BjI,EAC3C,CACA,aAAA6K,GACI,MAAMxG,EAAmBM,wBAC7B,CAIA,SAAAS,GACI,OAAOtF,KAAKD,MAChB,CAKA,SAAAiL,CAAUjL,GACNC,KAAKD,OAASA,CAClB,CAEA,gBAAA0H,CAAiB1G,GAKbf,KAAKD,OAAOkL,QAAQ,kDAExB,CACA,gBAAAjB,GACI,MAAMD,EAAiB/J,KAAK+E,iBAAiBiF,mBAC7C,YAAuBjL,IAAnBgL,EACO/J,KAAK+F,qBAAqBtD,mBAAmBsH,GAG7C,IAEf,CAEA,wBAAAmB,CAAyBC,EAAKC,GAM9B,CAEA,mBAAAC,CAAoBC,GAChBtL,KAAKD,OAAOkL,QAAQ,0DACxB,CACA,gBAAAM,GACI,OAAOvL,KAAKoF,MAChB,CACA,YAAAoG,GACI,OAAOxL,KAAK+E,iBAAiBY,sBACjC,CACA,gBAAA8F,GACI,OAAOzL,KAAK0F,aAChB,CACA,oBAAAgG,GACI,MAAMnH,EAAmBM,wBAC7B,CACA,mBAAA8G,GACI,MAAMpH,EAAmBM,wBAC7B,CAEA,gBAAM+G,CAAWjB,GACb,MAAMpG,EAAmBM,wBAC7B,CAEA,kBAAMgH,CAENrE,EAEAtH,GACI,MAAMqE,EAAmBM,wBAC7B,E","sources":["webpack://my-add-in/./node_modules/@azure/msal-browser/dist/naa/BridgeError.mjs","webpack://my-add-in/./node_modules/@azure/msal-browser/dist/naa/BridgeStatusCode.mjs","webpack://my-add-in/./node_modules/@azure/msal-browser/dist/naa/mapping/NestedAppAuthAdapter.mjs","webpack://my-add-in/./node_modules/@azure/msal-browser/dist/error/NestedAppAuthError.mjs","webpack://my-add-in/./node_modules/@azure/msal-browser/dist/controllers/NestedAppAuthController.mjs"],"sourcesContent":["/*! @azure/msal-browser v3.13.0 2024-04-11 */\n'use strict';\n/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\nfunction isBridgeError(error) {\n    return error.status !== undefined;\n}\n\nexport { isBridgeError };\n//# sourceMappingURL=BridgeError.mjs.map\n","/*! @azure/msal-browser v3.13.0 2024-04-11 */\n'use strict';\n/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\nconst BridgeStatusCode = {\n    UserInteractionRequired: \"USER_INTERACTION_REQUIRED\",\n    UserCancel: \"USER_CANCEL\",\n    NoNetwork: \"NO_NETWORK\",\n    TransientError: \"TRANSIENT_ERROR\",\n    PersistentError: \"PERSISTENT_ERROR\",\n    Disabled: \"DISABLED\",\n    AccountUnavailable: \"ACCOUNT_UNAVAILABLE\",\n    NestedAppAuthUnavailable: \"NESTED_APP_AUTH_UNAVAILABLE\", // NAA is unavailable in the current context, can retry with standard browser based auth\n};\n\nexport { BridgeStatusCode };\n//# sourceMappingURL=BridgeStatusCode.mjs.map\n","/*! @azure/msal-browser v3.13.0 2024-04-11 */\n'use strict';\nimport { RequestParameterBuilder, StringUtils, AuthenticationScheme, createClientAuthError, ClientAuthErrorCodes, AuthToken, AuthError, InteractionRequiredAuthError, ServerError, ClientAuthError, OIDC_DEFAULT_SCOPES } from '@azure/msal-common';\nimport { isBridgeError } from '../BridgeError.mjs';\nimport { BridgeStatusCode } from '../BridgeStatusCode.mjs';\n\n/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\nclass NestedAppAuthAdapter {\n    constructor(clientId, clientCapabilities, crypto, logger) {\n        this.clientId = clientId;\n        this.clientCapabilities = clientCapabilities;\n        this.crypto = crypto;\n        this.logger = logger;\n    }\n    toNaaTokenRequest(request) {\n        let extraParams;\n        if (request.extraQueryParameters === undefined) {\n            extraParams = new Map();\n        }\n        else {\n            extraParams = new Map(Object.entries(request.extraQueryParameters));\n        }\n        const requestBuilder = new RequestParameterBuilder();\n        const claims = requestBuilder.addClientCapabilitiesToClaims(request.claims, this.clientCapabilities);\n        const scopes = request.scopes || OIDC_DEFAULT_SCOPES;\n        const tokenRequest = {\n            platformBrokerId: request.account?.homeAccountId,\n            clientId: this.clientId,\n            authority: request.authority,\n            scope: scopes.join(\" \"),\n            correlationId: request.correlationId !== undefined\n                ? request.correlationId\n                : this.crypto.createNewGuid(),\n            claims: !StringUtils.isEmptyObj(claims) ? claims : undefined,\n            state: request.state,\n            authenticationScheme: request.authenticationScheme || AuthenticationScheme.BEARER,\n            extraParameters: extraParams,\n        };\n        return tokenRequest;\n    }\n    fromNaaTokenResponse(request, response, reqTimestamp) {\n        if (!response.token.id_token || !response.token.access_token) {\n            throw createClientAuthError(ClientAuthErrorCodes.nullOrEmptyToken);\n        }\n        const expiresOn = new Date((reqTimestamp + (response.token.expires_in || 0)) * 1000);\n        const idTokenClaims = AuthToken.extractTokenClaims(response.token.id_token, this.crypto.base64Decode);\n        const account = this.fromNaaAccountInfo(response.account, idTokenClaims);\n        const scopes = response.token.scope || request.scope;\n        const authenticationResult = {\n            authority: response.token.authority || account.environment,\n            uniqueId: account.localAccountId,\n            tenantId: account.tenantId,\n            scopes: scopes.split(\" \"),\n            account,\n            idToken: response.token.id_token,\n            idTokenClaims,\n            accessToken: response.token.access_token,\n            fromCache: true,\n            expiresOn: expiresOn,\n            tokenType: request.authenticationScheme || AuthenticationScheme.BEARER,\n            correlationId: request.correlationId,\n            extExpiresOn: expiresOn,\n            state: request.state,\n        };\n        return authenticationResult;\n    }\n    /*\n     *  export type AccountInfo = {\n     *     homeAccountId: string;\n     *     environment: string;\n     *     tenantId: string;\n     *     username: string;\n     *     localAccountId: string;\n     *     name?: string;\n     *     idToken?: string;\n     *     idTokenClaims?: TokenClaims & {\n     *         [key: string]:\n     *             | string\n     *             | number\n     *             | string[]\n     *             | object\n     *             | undefined\n     *             | unknown;\n     *     };\n     *     nativeAccountId?: string;\n     *     authorityType?: string;\n     * };\n     */\n    fromNaaAccountInfo(fromAccount, idTokenClaims) {\n        const effectiveIdTokenClaims = idTokenClaims || fromAccount.idTokenClaims;\n        const localAccountId = fromAccount.localAccountId ||\n            effectiveIdTokenClaims?.oid ||\n            effectiveIdTokenClaims?.sub ||\n            \"\";\n        const tenantId = fromAccount.tenantId || effectiveIdTokenClaims?.tid || \"\";\n        const homeAccountId = fromAccount.homeAccountId || `${localAccountId}.${tenantId}`;\n        const username = fromAccount.username ||\n            effectiveIdTokenClaims?.preferred_username ||\n            \"\";\n        const name = fromAccount.name || effectiveIdTokenClaims?.name;\n        const account = {\n            homeAccountId,\n            environment: fromAccount.environment,\n            tenantId,\n            username,\n            localAccountId,\n            name,\n            idToken: fromAccount.idToken,\n            idTokenClaims: effectiveIdTokenClaims,\n        };\n        return account;\n    }\n    /**\n     *\n     * @param error BridgeError\n     * @returns AuthError, ClientAuthError, ClientConfigurationError, ServerError, InteractionRequiredError\n     */\n    fromBridgeError(error) {\n        if (isBridgeError(error)) {\n            switch (error.status) {\n                case BridgeStatusCode.UserCancel:\n                    return new ClientAuthError(ClientAuthErrorCodes.userCanceled);\n                case BridgeStatusCode.NoNetwork:\n                    return new ClientAuthError(ClientAuthErrorCodes.noNetworkConnectivity);\n                case BridgeStatusCode.AccountUnavailable:\n                    return new ClientAuthError(ClientAuthErrorCodes.noAccountFound);\n                case BridgeStatusCode.Disabled:\n                    return new ClientAuthError(ClientAuthErrorCodes.nestedAppAuthBridgeDisabled);\n                case BridgeStatusCode.NestedAppAuthUnavailable:\n                    return new ClientAuthError(error.code ||\n                        ClientAuthErrorCodes.nestedAppAuthBridgeDisabled, error.description);\n                case BridgeStatusCode.TransientError:\n                case BridgeStatusCode.PersistentError:\n                    return new ServerError(error.code, error.description);\n                case BridgeStatusCode.UserInteractionRequired:\n                    return new InteractionRequiredAuthError(error.code, error.description);\n                default:\n                    return new AuthError(error.code, error.description);\n            }\n        }\n        else {\n            return new AuthError(\"unknown_error\", \"An unknown error occurred\");\n        }\n    }\n}\n\nexport { NestedAppAuthAdapter };\n//# sourceMappingURL=NestedAppAuthAdapter.mjs.map\n","/*! @azure/msal-browser v3.13.0 2024-04-11 */\n'use strict';\nimport { AuthError } from '@azure/msal-common';\n\n/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n/**\n * NestedAppAuthErrorMessage class containing string constants used by error codes and messages.\n */\nconst NestedAppAuthErrorMessage = {\n    unsupportedMethod: {\n        code: \"unsupported_method\",\n        desc: \"The PKCE code challenge and verifier could not be generated.\",\n    },\n};\nclass NestedAppAuthError extends AuthError {\n    constructor(errorCode, errorMessage) {\n        super(errorCode, errorMessage);\n        Object.setPrototypeOf(this, NestedAppAuthError.prototype);\n        this.name = \"NestedAppAuthError\";\n    }\n    static createUnsupportedError() {\n        return new NestedAppAuthError(NestedAppAuthErrorMessage.unsupportedMethod.code, NestedAppAuthErrorMessage.unsupportedMethod.desc);\n    }\n}\n\nexport { NestedAppAuthError, NestedAppAuthErrorMessage };\n//# sourceMappingURL=NestedAppAuthError.mjs.map\n","/*! @azure/msal-browser v3.13.0 2024-04-11 */\n'use strict';\nimport { DEFAULT_CRYPTO_IMPLEMENTATION, PerformanceEvents, TimeUtils } from '@azure/msal-common';\nimport { InteractionType, DEFAULT_REQUEST } from '../utils/BrowserConstants.mjs';\nimport { CryptoOps } from '../crypto/CryptoOps.mjs';\nimport { NestedAppAuthAdapter } from '../naa/mapping/NestedAppAuthAdapter.mjs';\nimport { NestedAppAuthError } from '../error/NestedAppAuthError.mjs';\nimport { EventHandler } from '../event/EventHandler.mjs';\nimport { EventType } from '../event/EventType.mjs';\n\n/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\nclass NestedAppAuthController {\n    constructor(operatingContext) {\n        this.operatingContext = operatingContext;\n        const proxy = this.operatingContext.getBridgeProxy();\n        if (proxy !== undefined) {\n            this.bridgeProxy = proxy;\n        }\n        else {\n            throw new Error(\"unexpected: bridgeProxy is undefined\");\n        }\n        // Set the configuration.\n        this.config = operatingContext.getConfig();\n        // Initialize logger\n        this.logger = this.operatingContext.getLogger();\n        // Initialize performance client\n        this.performanceClient = this.config.telemetry.client;\n        // Initialize the crypto class.\n        this.browserCrypto = operatingContext.isBrowserEnvironment()\n            ? new CryptoOps(this.logger, this.performanceClient)\n            : DEFAULT_CRYPTO_IMPLEMENTATION;\n        this.eventHandler = new EventHandler(this.logger, this.browserCrypto);\n        this.nestedAppAuthAdapter = new NestedAppAuthAdapter(this.config.auth.clientId, this.config.auth.clientCapabilities, this.browserCrypto, this.logger);\n    }\n    getBrowserStorage() {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    getEventHandler() {\n        return this.eventHandler;\n    }\n    static async createController(operatingContext) {\n        const controller = new NestedAppAuthController(operatingContext);\n        return Promise.resolve(controller);\n    }\n    initialize() {\n        // do nothing not required by this controller\n        return Promise.resolve();\n    }\n    ensureValidRequest(request) {\n        if (request?.correlationId) {\n            return request;\n        }\n        return {\n            ...request,\n            correlationId: this.browserCrypto.createNewGuid(),\n        };\n    }\n    async acquireTokenInteractive(request) {\n        const validRequest = this.ensureValidRequest(request);\n        this.eventHandler.emitEvent(EventType.ACQUIRE_TOKEN_START, InteractionType.Popup, validRequest);\n        const atPopupMeasurement = this.performanceClient.startMeasurement(PerformanceEvents.AcquireTokenPopup, validRequest.correlationId);\n        atPopupMeasurement?.add({ nestedAppAuthRequest: true });\n        try {\n            const naaRequest = this.nestedAppAuthAdapter.toNaaTokenRequest(validRequest);\n            const reqTimestamp = TimeUtils.nowSeconds();\n            const response = await this.bridgeProxy.getTokenInteractive(naaRequest);\n            const result = this.nestedAppAuthAdapter.fromNaaTokenResponse(naaRequest, response, reqTimestamp);\n            this.operatingContext.setActiveAccount(result.account);\n            this.eventHandler.emitEvent(EventType.ACQUIRE_TOKEN_SUCCESS, InteractionType.Popup, result);\n            atPopupMeasurement.add({\n                accessTokenSize: result.accessToken.length,\n                idTokenSize: result.idToken.length,\n            });\n            atPopupMeasurement.end({\n                success: true,\n                requestId: result.requestId,\n            });\n            return result;\n        }\n        catch (e) {\n            const error = this.nestedAppAuthAdapter.fromBridgeError(e);\n            this.eventHandler.emitEvent(EventType.ACQUIRE_TOKEN_FAILURE, InteractionType.Popup, null, e);\n            atPopupMeasurement.end({\n                success: false,\n            }, e);\n            throw error;\n        }\n    }\n    async acquireTokenSilentInternal(request) {\n        const validRequest = this.ensureValidRequest(request);\n        this.eventHandler.emitEvent(EventType.ACQUIRE_TOKEN_START, InteractionType.Silent, validRequest);\n        const ssoSilentMeasurement = this.performanceClient.startMeasurement(PerformanceEvents.SsoSilent, validRequest.correlationId);\n        ssoSilentMeasurement?.increment({\n            visibilityChangeCount: 0,\n        });\n        ssoSilentMeasurement?.add({\n            nestedAppAuthRequest: true,\n        });\n        try {\n            const naaRequest = this.nestedAppAuthAdapter.toNaaTokenRequest(validRequest);\n            const reqTimestamp = TimeUtils.nowSeconds();\n            const response = await this.bridgeProxy.getTokenSilent(naaRequest);\n            const result = this.nestedAppAuthAdapter.fromNaaTokenResponse(naaRequest, response, reqTimestamp);\n            this.operatingContext.setActiveAccount(result.account);\n            this.eventHandler.emitEvent(EventType.ACQUIRE_TOKEN_SUCCESS, InteractionType.Silent, result);\n            ssoSilentMeasurement?.add({\n                accessTokenSize: result.accessToken.length,\n                idTokenSize: result.idToken.length,\n            });\n            ssoSilentMeasurement?.end({\n                success: true,\n                requestId: result.requestId,\n            });\n            return result;\n        }\n        catch (e) {\n            const error = this.nestedAppAuthAdapter.fromBridgeError(e);\n            this.eventHandler.emitEvent(EventType.ACQUIRE_TOKEN_FAILURE, InteractionType.Silent, null, e);\n            ssoSilentMeasurement?.end({\n                success: false,\n            }, e);\n            throw error;\n        }\n    }\n    async acquireTokenPopup(request) {\n        return this.acquireTokenInteractive(request);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    acquireTokenRedirect(request) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    async acquireTokenSilent(silentRequest) {\n        return this.acquireTokenSilentInternal(silentRequest);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    acquireTokenByCode(request // eslint-disable-line @typescript-eslint/no-unused-vars\n    ) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    acquireTokenNative(request, apiId, // eslint-disable-line @typescript-eslint/no-unused-vars\n    accountId // eslint-disable-line @typescript-eslint/no-unused-vars\n    ) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    acquireTokenByRefreshToken(commonRequest, // eslint-disable-line @typescript-eslint/no-unused-vars\n    silentRequest // eslint-disable-line @typescript-eslint/no-unused-vars\n    ) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    /**\n     * Adds event callbacks to array\n     * @param callback\n     */\n    addEventCallback(callback) {\n        return this.eventHandler.addEventCallback(callback);\n    }\n    /**\n     * Removes callback with provided id from callback array\n     * @param callbackId\n     */\n    removeEventCallback(callbackId) {\n        this.eventHandler.removeEventCallback(callbackId);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    addPerformanceCallback(callback) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    removePerformanceCallback(callbackId) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    enableAccountStorageEvents() {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    disableAccountStorageEvents() {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    getAccount(accountFilter) {\n        throw NestedAppAuthError.createUnsupportedError();\n        // TODO: Look at standard implementation\n    }\n    getAccountByHomeId(homeAccountId) {\n        const currentAccount = this.operatingContext.getActiveAccount();\n        if (currentAccount !== undefined) {\n            if (currentAccount.homeAccountId === homeAccountId) {\n                return this.nestedAppAuthAdapter.fromNaaAccountInfo(currentAccount);\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return null;\n        }\n    }\n    getAccountByLocalId(localId) {\n        const currentAccount = this.operatingContext.getActiveAccount();\n        if (currentAccount !== undefined) {\n            if (currentAccount.localAccountId === localId) {\n                return this.nestedAppAuthAdapter.fromNaaAccountInfo(currentAccount);\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return null;\n        }\n    }\n    getAccountByUsername(userName) {\n        const currentAccount = this.operatingContext.getActiveAccount();\n        if (currentAccount !== undefined) {\n            if (currentAccount.username === userName) {\n                return this.nestedAppAuthAdapter.fromNaaAccountInfo(currentAccount);\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return null;\n        }\n    }\n    getAllAccounts() {\n        const currentAccount = this.operatingContext.getActiveAccount();\n        if (currentAccount !== undefined) {\n            return [\n                this.nestedAppAuthAdapter.fromNaaAccountInfo(currentAccount),\n            ];\n        }\n        else {\n            return [];\n        }\n    }\n    handleRedirectPromise(hash // eslint-disable-line @typescript-eslint/no-unused-vars\n    ) {\n        return Promise.resolve(null);\n    }\n    loginPopup(request // eslint-disable-line @typescript-eslint/no-unused-vars\n    ) {\n        return this.acquireTokenInteractive(request || DEFAULT_REQUEST);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    loginRedirect(request) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    logout(logoutRequest) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    logoutRedirect(logoutRequest // eslint-disable-line @typescript-eslint/no-unused-vars\n    ) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    logoutPopup(logoutRequest // eslint-disable-line @typescript-eslint/no-unused-vars\n    ) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    ssoSilent(\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    request) {\n        return this.acquireTokenSilentInternal(request);\n    }\n    getTokenCache() {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    /**\n     * Returns the logger instance\n     */\n    getLogger() {\n        return this.logger;\n    }\n    /**\n     * Replaces the default logger set in configurations with new Logger with new configurations\n     * @param logger Logger instance\n     */\n    setLogger(logger) {\n        this.logger = logger;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    setActiveAccount(account) {\n        /*\n         * StandardController uses this to allow the developer to set the active account\n         * in the nested app auth scenario the active account is controlled by the app hosting the nested app\n         */\n        this.logger.warning(\"nestedAppAuth does not support setActiveAccount\");\n        return;\n    }\n    getActiveAccount() {\n        const currentAccount = this.operatingContext.getActiveAccount();\n        if (currentAccount !== undefined) {\n            return this.nestedAppAuthAdapter.fromNaaAccountInfo(currentAccount);\n        }\n        else {\n            return null;\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    initializeWrapperLibrary(sku, version) {\n        /*\n         * Standard controller uses this to set the sku and version of the wrapper library in the storage\n         * we do nothing here\n         */\n        return;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    setNavigationClient(navigationClient) {\n        this.logger.warning(\"setNavigationClient is not supported in nested app auth\");\n    }\n    getConfiguration() {\n        return this.config;\n    }\n    isBrowserEnv() {\n        return this.operatingContext.isBrowserEnvironment();\n    }\n    getBrowserCrypto() {\n        return this.browserCrypto;\n    }\n    getPerformanceClient() {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    getRedirectResponse() {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    async clearCache(logoutRequest) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    async hydrateCache(\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    result, \n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    request) {\n        throw NestedAppAuthError.createUnsupportedError();\n    }\n}\n\nexport { NestedAppAuthController };\n//# sourceMappingURL=NestedAppAuthController.mjs.map\n"],"names":["isBridgeError","error","undefined","status","BridgeStatusCode","UserInteractionRequired","UserCancel","NoNetwork","TransientError","PersistentError","Disabled","AccountUnavailable","NestedAppAuthUnavailable","NestedAppAuthAdapter","constructor","clientId","clientCapabilities","crypto","logger","this","toNaaTokenRequest","request","extraParams","extraQueryParameters","Map","Object","entries","requestBuilder","RequestParameterBuilder","claims","addClientCapabilitiesToClaims","scopes","tokenRequest","platformBrokerId","account","homeAccountId","authority","scope","join","correlationId","createNewGuid","StringUtils","isEmptyObj","state","authenticationScheme","BEARER","extraParameters","fromNaaTokenResponse","response","reqTimestamp","token","id_token","access_token","ClientAuthErrorCodes","expiresOn","Date","expires_in","idTokenClaims","AuthToken","base64Decode","fromNaaAccountInfo","authenticationResult","environment","uniqueId","localAccountId","tenantId","split","idToken","accessToken","fromCache","tokenType","extExpiresOn","fromAccount","effectiveIdTokenClaims","oid","sub","tid","username","preferred_username","name","fromBridgeError","AuthError","ClientAuthError","code","description","ServerError","InteractionRequiredAuthError","NestedAppAuthErrorMessage","unsupportedMethod","desc","NestedAppAuthError","errorCode","errorMessage","super","setPrototypeOf","prototype","createUnsupportedError","NestedAppAuthController","operatingContext","proxy","getBridgeProxy","Error","bridgeProxy","config","getConfig","getLogger","performanceClient","telemetry","client","browserCrypto","isBrowserEnvironment","CryptoOps","eventHandler","EventHandler","nestedAppAuthAdapter","auth","getBrowserStorage","getEventHandler","createController","controller","Promise","resolve","initialize","ensureValidRequest","acquireTokenInteractive","validRequest","emitEvent","EventType","ACQUIRE_TOKEN_START","Popup","atPopupMeasurement","startMeasurement","PerformanceEvent","AcquireTokenPopup","add","nestedAppAuthRequest","naaRequest","TimeUtils","getTokenInteractive","result","setActiveAccount","ACQUIRE_TOKEN_SUCCESS","accessTokenSize","length","idTokenSize","end","success","requestId","e","ACQUIRE_TOKEN_FAILURE","acquireTokenSilentInternal","Silent","ssoSilentMeasurement","SsoSilent","increment","visibilityChangeCount","getTokenSilent","acquireTokenPopup","acquireTokenRedirect","acquireTokenSilent","silentRequest","acquireTokenByCode","acquireTokenNative","apiId","accountId","acquireTokenByRefreshToken","commonRequest","addEventCallback","callback","removeEventCallback","callbackId","addPerformanceCallback","removePerformanceCallback","enableAccountStorageEvents","disableAccountStorageEvents","getAccount","accountFilter","getAccountByHomeId","currentAccount","getActiveAccount","getAccountByLocalId","localId","getAccountByUsername","userName","getAllAccounts","handleRedirectPromise","hash","loginPopup","loginRedirect","logout","logoutRequest","logoutRedirect","logoutPopup","ssoSilent","getTokenCache","setLogger","warning","initializeWrapperLibrary","sku","version","setNavigationClient","navigationClient","getConfiguration","isBrowserEnv","getBrowserCrypto","getPerformanceClient","getRedirectResponse","clearCache","hydrateCache"],"sourceRoot":""}